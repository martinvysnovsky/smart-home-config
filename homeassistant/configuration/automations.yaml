# ================================================================================
# Scene Management - Presence-based automation for home and away modes
# ================================================================================

- id: '1696262663910'
  alias: Enable Home scene when someone enters home
  description: Activates home scene (privacy on, motion detection off) when anyone
    arrives at the main home
  triggers:
  - trigger: state
    entity_id:
    - zone.home
    from: '0'
  conditions: []
  actions:
  - target:
      entity_id: scene.home
    metadata: {}
    action: scene.turn_on
    data: {}
  mode: single

- id: '1696262790329'
  alias: Enable Away scene when everybody leave home
  description: Activates away scene (privacy off, motion detection on) when everyone
    leaves the main home
  triggers:
  - trigger: state
    entity_id:
    - zone.home
    to: '0'
  conditions: []
  actions:
  - target:
      entity_id: scene.away
    metadata: {}
    action: scene.turn_on
    data: {}
  mode: single

- id: '1696358130652'
  alias: Enable Away from Kvetoslavov scene when everybody leaves Kvetoslavov
  description: Activates away scene (NVR disarming off, event notifications on) when
    everyone leaves Kvetoslavov
  triggers:
  - trigger: state
    entity_id:
    - zone.kvetoslavov_home
    from:
    to: '0'
  conditions: []
  actions:
  - target:
      entity_id: scene.away_from_kvetoslavov
    metadata: {}
    action: scene.turn_on
    data: {}
  mode: single

- id: '1696358193297'
  alias: Enable In Kvetoslavov scene when someone enters Kvetoslavov
  description: Activates home scene (NVR disarming on, event notifications off) when
    anyone arrives at Kvetoslavov
  triggers:
  - trigger: state
    entity_id:
    - zone.kvetoslavov_home
    from: '0'
    to:
  conditions: []
  actions:
  - target:
      entity_id: scene.in_kvetoslavov
    metadata: {}
    action: scene.turn_on
    data: {}
  mode: single

# ================================================================================
# Vacuum Cleaning - Automated vacuum scheduling based on presence
# ================================================================================

- id: '1733918666189'
  alias: Start Xiaomi when leaving home
  description: Starts Xiaomi vacuum in sweeping mode when everyone leaves home during
    daytime (08:00-22:00)
  triggers:
  - entity_id:
    - person.martin_vysnovsky
    - person.lidia_silanteva
    zone: zone.home
    event: leave
    trigger: zone
  conditions:
  - condition: state
    entity_id: zone.home
    state: '0'
  - condition: time
    after: 08:00:00
    before: '22:00:00'
  actions:
  - action: input_boolean.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.cleaup_started_by_automation
  - action: select.select_option
    target:
      entity_id: select.xiaomi_robot_vacuum_x20_cleaning_mode
    data:
      option: sweeping
  - action: vacuum.start
    metadata: {}
    data: {}
    target:
      entity_id:
      - vacuum.xiaomi_robot_vacuum_x20
  mode: single

- id: '1733918504232'
  alias: Dock Xiaomi when entering home
  description: Returns Xiaomi vacuum to dock when someone arrives home if it was started
    by automation
  triggers:
  - trigger: state
    entity_id:
    - zone.home
    from: '0'
    to:
  conditions:
  - condition: state
    entity_id: vacuum.xiaomi_robot_vacuum_x20
    state: cleaning
  - condition: state
    entity_id: input_boolean.cleaup_started_by_automation
    state: 'on'
  actions:
  - action: vacuum.return_to_base
    target:
      entity_id: vacuum.xiaomi_robot_vacuum_x20
  mode: single

- id: '1736416573587'
  alias: Reset flag Cleanup started by automation
  description: Resets the automation flag when Xiaomi vacuum returns to dock
  triggers:
  - trigger: state
    entity_id: vacuum.xiaomi_robot_vacuum_x20
    to: docked
  conditions: []
  actions:
  - action: input_boolean.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.cleaup_started_by_automation
  mode: single

# ================================================================================
# Pet Care - Litter robot and bathroom cleaning automation
# ================================================================================

- id: '1733920534581'
  alias: Clean bathroom after Litter Robot run
  description: Triggers bathroom cleaning with Xiaomi vacuum after Litter Robot finishes
    cleaning cycle (08:00-21:30)
  triggers:
  - trigger: state
    entity_id:
    - sensor.litter_robot_4_status_code
    to:
    - ccp
  conditions:
  - condition: time
    after: 08:00:00
    before: '21:30:00'
  - condition: not
    conditions:
    - condition: state
      entity_id: vacuum.xiaomi_robot_vacuum_x20
      state: cleaning
  actions:
  - action: script.clean_bathroom
    metadata: {}
    data: {}
  mode: single

- id: '1736690440951'
  alias: Litter-robot waste full
  description: Sends mobile notification when Litter Robot waste drawer reaches 70%
    capacity
  triggers:
  - trigger: numeric_state
    entity_id:
    - sensor.litter_robot_4_waste_drawer
    above: 70
  conditions: []
  actions:
  - action: notify.mobile_app_pixel_8_pro
    metadata: {}
    data:
      message: Litter-robot waste above 70%
  - action: notify.mobile_app_pixel_9a
    metadata: {}
    data:
      message: Litter-robot waste above 70%
  mode: single

# ================================================================================
# Day/Night Management - Sunrise and sunset automation for curtains
# ================================================================================

- id: '1736274045296'
  alias: Activate day mode
  description: Opens living room curtains, sets day mode flag, and switches to light
    theme at sunrise
  triggers:
  - trigger: sun
    event: sunrise
    offset: 0
  conditions: []
  actions:
  - action: scene.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: scene.day_mode
  - action: frontend.set_theme
    data:
      name: Catppuccin Latte
  mode: single

- id: '1736274083799'
  alias: Activate night mode
  description: Closes living room curtains, sets night mode flag, and switches to
    dark theme at sunset
  triggers:
  - trigger: sun
    event: sunset
    offset: 0
  conditions: []
  actions:
  - action: scene.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: scene.night_mode
  - action: frontend.set_theme
    data:
      name: Catppuccin Mocha
  mode: single

# ================================================================================
# Location-based Notifications - Context-aware mobile alerts
# ================================================================================

- id: '1696626728530'
  alias: Open shopping list when entering a shop
  description: Sends notification with shopping list link when either person enters
    Lidl
  trigger:
  - platform: geo_location
    source: person.martin_vysnovsky
    zone: zone.lidl
    event: enter
    id: martin
  - platform: geo_location
    source: person.lidia_silanteva
    zone: zone.lidl
    event: enter
    id: lidia
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: martin
      sequence:
      - service: notify.mobile_app_pixel_8_pro
        data:
          message: Open your shopping list?
          data:
            clickAction: /lovelace/shopping-list
            url: /lovelace/shopping-list
          title: Shopping list
    - conditions:
      - condition: trigger
        id: lidia
      sequence:
      - service: notify.mobile_app_pixel_9a
        data:
          message: Open your shopping list?
          data:
            clickAction: /lovelace/shopping-list
            url: /lovelace/shopping-list
          title: Shopping list
  mode: single
